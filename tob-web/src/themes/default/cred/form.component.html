<section id="cred-form" *ngIf="(result$ | async) as result">
  <loading-indicator [loading]="result.loading"></loading-indicator>
  <error-message [error]="result.error"></error-message>

  <div class="row" *ngIf="result.data as record">
    <div class="col-md-7 col-sm-6">
      <h1 class="cred-title">{{record.credential_type.description}}</h1>

      <a [routerLink]="['/topic/', record.topic.id] | localize" class="title-back-link mrgn-bttm-md">
        <span class="fa fa-arrow-left"></span> {{'topic.return-link' | translate}}</a>

      <div class="cred-info">
        <div class="row form-group" *ngIf="record.revoked">
          <div class="col-sm-12">
            <div class="alert alert-danger">
              <h3 translate>cred.expired</h3>
              <p translate>cred.expired-message</p>
            </div>
          </div>
        </div>
        <div class="row form-group" *ngIf="record.haveNames">
          <div class="col-sm-12">
            <label class="control-label" translate>cred.names</label>
            <div class="form-field">
              <ul class="claim-list">
                <li *ngFor="let name of record.names">
                  <label translate>{{name.type}}</label>
                  <span class="claim-info name">{{name.text}}</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row form-group" *ngIf="record.haveContacts">
          <div class="col-sm-12">
            <label class="control-label" translate>cred.contact</label>
            <div class="form-field">
              <ul class="claim-list">
                <li *ngFor="let contact of record.contacts">
                  <label translate>{{contact.type}}</label>
                  <span class="claim-info {{contact.typeClass}}">{{contact.text}}</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row form-group" *ngIf="record.havePeople">
          <div class="col-sm-12">
            <label class="control-label" translate>cred.people</label>
            <div class="form-field">
              <ul class="claim-list">
                <li *ngFor="let person of record.people">
                  <label translate>{{person.type}}</label>
                  <span class="claim-info person">{{person.full_name}}</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row form-group" *ngIf="record.haveAddresses">
          <div class="col-sm-12">
            <label class="control-label" translate>cred.addresses</label>
            <div class="form-field">
              <ul class="claim-list">
                <li *ngFor="let address of record.addresses">
                  <label translate>{{address.type}}</label>
                  <address-view [record]="address"></address-view>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-5 col-sm-6">
      <div class="meta-info well mrgn-tp-lg">
        <h3 class="well-title">Credential Info</h3>
        <div class="meta-body form-body">
          <div class="row form-group" *ngIf="record.issuer">
            <div class="col-sm-12">
              <label class="control-label" translate>cred.issuer</label>
              <div class="form-field">
                <a class="body-link issuer-link" [routerLink]="['/issuer', record.issuer.id] | localize">{{record.issuer.name}}</a>
              </div>
            </div>
          </div>
          <div class="row form-group">
            <div class="col-sm-12">
              <label class="control-label" translate>cred.start-date</label>
              <div class="form-field">
                <span class="claim-info date" *ngIf="record.effective_date">{{record.effective_date | dateFormat: 'effectiveDateTime'}}</span>
              </div>
            </div>
          </div>
          <div class="cred-verify" *ngIf="! record.revoked">
            <div class="row form-group mrgn-tp-lg">
              <div class="col-sm-6">
                <button type="button" [class]="'btn btn-primary btn-verify' + (verifying ? ' loading' : '')" (click)="verifyCred($event)">
                  <span class="fa fa-accept"></span> {{'cred.verify-button-label' | translate}}</button>
              </div>
              <div class="col-sm-6 mrgn-tp-sm">
                <a class="body-link verify-help" href="#">
                  <span class="fa fa-question-circle"></span>
                  <span translate>cred.whats-this-link</span>
                </a>
              </div>
            </div>
            <div class="row form-group" *ngIf="(verify$ | async) as verify">
              <div class="col-sm-12" *ngIf="verify.loading">
                <section class="alert alert-info">
                  <p translate>cred.requesting-proof</p>
                </section>
              </div>
              <error-message [error]="verify.error"></error-message>
              <div class="col-sm-12" *ngIf="verify.data as verifyData">
                <div [class]="'verify-result mrgn-bttm-0 panel panel-' + (verifyData.success ? 'success' : 'warning')">
                  <div class="panel-heading">
                    {{'cred.verify-status' | translate}} {{verifyData.status | translate}}
                  </div>
                  <div class="panel-body" *ngIf="verifyData.sucess">
                    <code>{{verifyData.text}}</code>
                  </div>
                  <div class="panel-body" *ngIf="! verifyData.sucess">
                    {{verifyData.text}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</section>
